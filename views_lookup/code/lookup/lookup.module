<?php

/**
 * hook_menu
 */
function lookup_menu(){

//TODO:define the url path(lookup/get/views) for view content page
  $items = array();

  $items['lookup/test/testDrupal'] = array(
    'title' => t('Test Form'),
    'page callback' => 'drupal_get_form',
    'page arguments' => array('lookup_test_form'),
    'access arguments' => array('test form'),
    'menu_name' => 'main-menu', //to display in main menu
    'file' => 'test/lookup.test.inc',
  );

  var_dump($items);
  return $items;

}

/**
 * hook_element_info_alter
 */
function lookup_element_info_alter(&$type){
  //TODO: use the #pre_render of textfield to wrapper the browse link
  if (!isset($type['textfield']['#pre_render'])) {
    $type['textfield']['#pre_render'] = array();
  }
  array_unshift($type['textfield']['#pre_render'],
      'lookup_textfield_pre_render_callback');
}

function lookup_textfield_pre_render_callback($element) {
  if(isset($element['#type']) && $element['#type'] == 'textfield'
  && isset($element['#lookup']) && $element['#lookup'] == TRUE) {
    drupal_add_library('system', 'ui.dialog');
    $path = drupal_get_path('module', 'lookup');
    $element['#field_suffix'] = '<a href="#">
                                   <img src="' . $path . '/img/search.png">
                                 </a>';
  }
  return $element;
}

/**
 * Implements hook_views api
 */
function lookup_views_api() {
  return array(
    'api' => 3,
    'path' => drupal_get_path('module', 'lookup') . '/test/views',
      // 'template path' => drupal_get_path('module', 'example') . 'themes',
  );
}

/**
 * Implement hook_permission().
 */
function lookup_permission() {
  return array(
    'test form' => array('title' => t('Test Form'),),
  );
}




